const puppeteer = require('puppeteer');
const fs = require('fs');
const path = require('path');

// Все должности из оргструктуры v2
const positions = [
  // Руководство
  { id: '01', title: 'Генеральный директор', dept: 'Руководство', reports: '—', subordinates: 'Технический директор, Начальник производства, Руководитель ПДО', duties: ['Общее руководство деятельностью предприятия', 'Определение стратегии развития компании', 'Утверждение бюджета и инвестиционных программ', 'Подбор и назначение руководителей подразделений', 'Представление интересов компании перед контрагентами', 'Контроль финансово-хозяйственной деятельности', 'Принятие решений по крупным сделкам и контрактам'], requirements: ['Высшее техническое или экономическое образование', 'Опыт руководства производственным предприятием от 5 лет', 'Знание технологий металлообработки', 'Навыки стратегического управления'] },
  
  { id: '02', title: 'Технический директор', dept: 'Руководство', reports: 'Генеральный директор', subordinates: 'Начальник КБ, Начальник ОТК, Главный технолог, Главный механик', duties: ['Руководство технической политикой предприятия', 'Обеспечение качества выпускаемой продукции', 'Контроль технологической дисциплины', 'Внедрение новых технологий и оборудования', 'Согласование технической документации', 'Руководство КБ, ОТК, технологическим отделом', 'Взаимодействие с заказчиками по техническим вопросам'], requirements: ['Высшее техническое образование', 'Опыт работы в металлообработке от 5 лет', 'Знание CAD/CAM систем', 'Опыт управления техническими подразделениями'] },
  
  { id: '03', title: 'Начальник производства', dept: 'Руководство', reports: 'Генеральный директор', subordinates: 'Зам. начальника производства, Мастера участков', duties: ['Организация производственного процесса', 'Выполнение плана производства в срок', 'Оперативное управление участками', 'Контроль эффективности использования оборудования', 'Обеспечение безопасных условий труда', 'Управление персоналом производства', 'Снижение производственных потерь и брака'], requirements: ['Высшее техническое образование', 'Опыт управления производством от 3 лет', 'Знание технологий металлообработки', 'Навыки планирования и организации'] },
  
  { id: '04', title: 'Руководитель ПДО', dept: 'Руководство', reports: 'Генеральный директор', subordinates: 'Начальник ПДО, Начальник снабжения, Логист, Заведующий складом', duties: ['Координация материальных потоков предприятия', 'Обеспечение своевременного снабжения производства', 'Организация складского хозяйства', 'Контроль запасов сырья и готовой продукции', 'Организация отгрузки продукции заказчикам', 'Оптимизация логистических издержек', 'Работа с поставщиками и перевозчиками'], requirements: ['Высшее образование (логистика, экономика)', 'Опыт в снабжении/логистике от 3 лет', 'Знание 1С, Excel', 'Навыки ведения переговоров'] },

  // Блок Техдиректора - КБ
  { id: '05', title: 'Начальник КБ', dept: 'Конструкторское бюро', reports: 'Технический директор', subordinates: 'Инженеры-конструкторы, Чертёжники', duties: ['Руководство конструкторским бюро', 'Распределение задач между конструкторами', 'Проверка и утверждение КД', 'Согласование техзаданий с заказчиками', 'Контроль сроков разработки документации', 'Внедрение стандартов и типовых решений', 'Ведение архива конструкторской документации'], requirements: ['Высшее техническое образование', 'Опыт конструкторской работы от 5 лет', 'Владение SolidWorks, AutoCAD, Компас', 'Знание ЕСКД, ГОСТ на металлоконструкции'] },
  
  { id: '06', title: 'Инженер-конструктор', dept: 'Конструкторское бюро', reports: 'Начальник КБ', subordinates: '—', duties: ['Разработка конструкторской документации', 'Создание 3D-моделей изделий', 'Выпуск рабочих чертежей и спецификаций', 'Расчёт прочности и устойчивости конструкций', 'Разработка узлов крепления', 'Авторский надзор за изготовлением', 'Внесение изменений в документацию'], requirements: ['Высшее техническое образование', 'Опыт работы конструктором от 2 лет', 'Владение SolidWorks или Компас-3D', 'Знание материаловедения'] },
  
  { id: '07', title: 'Чертёжник / CAD-оператор', dept: 'Конструкторское бюро', reports: 'Начальник КБ', subordinates: '—', duties: ['Оформление чертежей по эскизам конструкторов', 'Внесение изменений в чертежи', 'Создание развёрток для раскроя', 'Подготовка файлов для станков ЧПУ (DXF)', 'Ведение электронного архива чертежей', 'Печать и комплектация документации', 'Нумерация и регистрация документов'], requirements: ['Среднее специальное или высшее образование', 'Владение AutoCAD, SolidWorks', 'Знание ЕСКД', 'Опыт работы с чертежами от 1 года'] },

  // Блок Техдиректора - ОТК
  { id: '08', title: 'Начальник ОТК', dept: 'Отдел технического контроля', reports: 'Технический директор', subordinates: 'Контролёры ОТК', duties: ['Руководство службой технического контроля', 'Разработка методик контроля качества', 'Анализ причин брака и рекламаций', 'Ведение статистики качества', 'Участие в приёмке продукции заказчиком', 'Работа с несоответствующей продукцией', 'Взаимодействие с поставщиками по качеству'], requirements: ['Высшее техническое образование', 'Опыт работы в ОТК от 3 лет', 'Знание методов контроля качества', 'Владение измерительным инструментом'] },
  
  { id: '09', title: 'Контролёр ОТК', dept: 'Отдел технического контроля', reports: 'Начальник ОТК', subordinates: '—', duties: ['Входной контроль сырья и материалов', 'Операционный контроль на участках', 'Выходной контроль готовой продукции', 'Проверка геометрических параметров', 'Контроль качества покрытия', 'Оформление актов о браке', 'Клеймение годной продукции'], requirements: ['Среднее специальное образование', 'Опыт работы контролёром от 1 года', 'Умение читать чертежи', 'Владение измерительным инструментом'] },

  // Блок Техдиректора - Технологи
  { id: '10', title: 'Главный технолог', dept: 'Технологический отдел', reports: 'Технический директор', subordinates: 'Инженеры-технологи', duties: ['Руководство технологической подготовкой производства', 'Разработка и утверждение техпроцессов', 'Нормирование трудозатрат и материалов', 'Выбор режимов обработки', 'Проектирование оснастки', 'Внедрение новых технологий', 'Решение технологических проблем'], requirements: ['Высшее техническое образование', 'Опыт работы технологом от 5 лет', 'Знание технологий металлообработки', 'Владение CAD/CAM системами'] },
  
  { id: '11', title: 'Инженер-технолог', dept: 'Технологический отдел', reports: 'Главный технолог', subordinates: '—', duties: ['Разработка маршрутных и операционных карт', 'Расчёт норм расхода материалов', 'Нормирование трудозатрат', 'Разработка управляющих программ ЧПУ', 'Подбор режимов резки, гибки, сварки', 'Сопровождение производства', 'Анализ и устранение техпроблем'], requirements: ['Высшее техническое образование', 'Опыт работы технологом от 2 лет', 'Знание металлообработки', 'Владение CAD/CAM'] },

  // Блок Техдиректора - Механик
  { id: '12', title: 'Главный механик', dept: 'Служба главного механика', reports: 'Технический директор', subordinates: 'Наладчики, Электрики', duties: ['Организация технического обслуживания оборудования', 'Планирование ППР (планово-предупредительных ремонтов)', 'Контроль технического состояния станков', 'Организация аварийных ремонтов', 'Заказ запасных частей', 'Ведение паспортов оборудования', 'Модернизация оборудования'], requirements: ['Высшее техническое образование', 'Опыт обслуживания промоборудования от 5 лет', 'Знание станков ЧПУ', 'Навыки диагностики неисправностей'] },
  
  { id: '13', title: 'Наладчик оборудования', dept: 'Служба главного механика', reports: 'Главный механик', subordinates: '—', duties: ['Наладка станков ЧПУ перед работой', 'Настройка параметров обработки', 'Замена инструмента и оснастки', 'Устранение мелких неисправностей', 'Калибровка оборудования', 'Ведение журналов наладки', 'Обучение операторов работе на станках'], requirements: ['Среднее специальное образование', 'Опыт работы наладчиком от 2 лет', 'Знание станков ЧПУ (лазер, листогиб, КПП)', 'Умение читать чертежи'] },
  
  { id: '14', title: 'Электрик', dept: 'Служба главного механика', reports: 'Главный механик', subordinates: '—', duties: ['Обслуживание электрооборудования', 'Ремонт электрических систем станков', 'Монтаж и подключение оборудования', 'Проверка заземления и изоляции', 'Замена электрокомпонентов', 'Ведение электрохозяйства', 'Соблюдение правил электробезопасности'], requirements: ['Среднее специальное образование', 'Группа допуска по электробезопасности от III', 'Опыт работы электриком от 2 лет', 'Знание промышленного электрооборудования'] },

  // Блок Начальника производства
  { id: '15', title: 'Заместитель начальника производства', dept: 'Производство', reports: 'Начальник производства', subordinates: 'Мастера участков (оперативно)', duties: ['Оперативное управление производством', 'Проведение ежедневных планёрок с мастерами', 'Контроль выполнения сменных заданий', 'Координация работы участков', 'Решение оперативных проблем', 'Замещение начальника производства', 'Контроль дисциплины на производстве'], requirements: ['Высшее техническое образование', 'Опыт работы на производстве от 3 лет', 'Навыки оперативного управления', 'Знание технологий металлообработки'] },
  
  { id: '16', title: 'Мастер участка', dept: 'Производство', reports: 'Начальник производства', subordinates: 'Операторы, рабочие участка', duties: ['Руководство работой участка', 'Распределение заданий между рабочими', 'Контроль качества выполнения операций', 'Обеспечение выполнения плана участка', 'Контроль соблюдения техпроцесса', 'Инструктаж рабочих по охране труда', 'Ведение сменной документации', 'Контроль состояния оборудования'], requirements: ['Среднее специальное или высшее образование', 'Опыт работы на производстве от 3 лет', 'Знание технологии своего участка', 'Навыки управления коллективом'] },

  // Операторы заготовительного участка
  { id: '17', title: 'Оператор лазерного станка', dept: 'Заготовительный участок', reports: 'Мастер участка', subordinates: '—', duties: ['Управление лазерным станком ЧПУ', 'Загрузка управляющих программ', 'Установка и базирование листа', 'Контроль качества реза', 'Сортировка и маркировка заготовок', 'Уход за оборудованием', 'Контроль расхода газа и сопел'], requirements: ['Среднее специальное образование', 'Опыт работы на станках ЧПУ от 1 года', 'Умение читать чертежи', 'Знание свойств металлов'] },
  
  { id: '18', title: 'Оператор координатно-пробивного пресса', dept: 'Заготовительный участок', reports: 'Мастер участка', subordinates: '—', duties: ['Управление КПП (координатно-пробивным прессом)', 'Загрузка программ пробивки/вырубки', 'Установка пуансонов и матриц', 'Контроль качества пробивки', 'Сортировка заготовок', 'Техобслуживание пресса', 'Контроль износа инструмента'], requirements: ['Среднее специальное образование', 'Опыт работы на прессах от 1 года', 'Умение читать чертежи', 'Знание инструмента для пробивки'] },
  
  { id: '19', title: 'Оператор гильотины', dept: 'Заготовительный участок', reports: 'Мастер участка', subordinates: '—', duties: ['Резка листового металла на гильотине', 'Настройка зазора ножей', 'Контроль размеров заготовок', 'Раскрой по картам раскроя', 'Маркировка заготовок', 'Уход за оборудованием', 'Соблюдение техники безопасности'], requirements: ['Среднее образование', 'Опыт работы на гильотине от 6 мес', 'Умение читать чертежи', 'Знание свойств металлов'] },
  
  { id: '20', title: 'Стропальщик', dept: 'Заготовительный участок', reports: 'Мастер участка', subordinates: '—', duties: ['Строповка и перемещение грузов краном', 'Подача листов на станки', 'Перемещение заготовок между участками', 'Проверка грузозахватных приспособлений', 'Соблюдение схем строповки', 'Взаимодействие с крановщиком', 'Складирование заготовок'], requirements: ['Удостоверение стропальщика', 'Опыт работы от 6 мес', 'Знание схем строповки', 'Физическая выносливость'] },

  // Гибочный участок
  { id: '21', title: 'Оператор листогиба', dept: 'Гибочный участок', reports: 'Мастер участка', subordinates: '—', duties: ['Управление листогибочным прессом ЧПУ', 'Загрузка программ гибки', 'Подбор и установка пуансонов/матриц', 'Гибка деталей по чертежам', 'Контроль углов и размеров', 'Корректировка программ', 'Уход за оборудованием'], requirements: ['Среднее специальное образование', 'Опыт работы на листогибе от 1 года', 'Умение читать чертежи развёрток', 'Знание припусков на гибку'] },
  
  { id: '22', title: 'Оператор панелегиба', dept: 'Гибочный участок', reports: 'Мастер участка', subordinates: '—', duties: ['Управление панелегибом (Salvagnini и др.)', 'Загрузка программ автоматической гибки', 'Контроль качества гибки кассет', 'Настройка параметров гибки', 'Работа с тонколистовым металлом', 'Сортировка готовых изделий', 'Техобслуживание оборудования'], requirements: ['Среднее специальное образование', 'Опыт работы на гибочном оборудовании от 1 года', 'Знание технологии гибки', 'Умение читать чертежи'] },
  
  { id: '23', title: 'Подсобный рабочий', dept: 'Производство', reports: 'Мастер участка', subordinates: '—', duties: ['Подача заготовок на рабочие места', 'Уборка отходов производства', 'Перемещение деталей между операциями', 'Упаковка мелких деталей', 'Поддержание чистоты на участке', 'Помощь операторам при загрузке', 'Выполнение поручений мастера'], requirements: ['Среднее образование', 'Физическая выносливость', 'Ответственность', 'Готовность к обучению'] },

  // Сварочный участок
  { id: '24', title: 'Сварщик', dept: 'Сварочный участок', reports: 'Мастер участка', subordinates: '—', duties: ['Сварка алюминия методом TIG/MIG', 'Сварка стали методом MIG/MAG', 'Подготовка кромок под сварку', 'Контроль качества сварных швов', 'Зачистка швов', 'Работа по чертежам и эскизам', 'Уход за сварочным оборудованием'], requirements: ['Удостоверение сварщика (НАКС)', 'Опыт сварки алюминия от 2 лет', 'Владение TIG, MIG сваркой', 'Умение читать чертежи'] },
  
  { id: '25', title: 'Слесарь-сборщик', dept: 'Сварочный участок', reports: 'Мастер участка', subordinates: '—', duties: ['Сборка металлоконструкций на заклёпках/болтах', 'Подгонка деталей', 'Сверление отверстий', 'Установка крепежа', 'Контроль геометрии сборки', 'Подготовка изделий под сварку', 'Работа по сборочным чертежам'], requirements: ['Среднее специальное образование', 'Опыт слесарных работ от 1 года', 'Умение читать сборочные чертежи', 'Владение ручным инструментом'] },

  // Покрасочный участок
  { id: '26', title: 'Подготовщик поверхности', dept: 'Покрасочный участок', reports: 'Мастер участка', subordinates: '—', duties: ['Подготовка изделий к покраске', 'Обезжиривание поверхностей', 'Нанесение конверсионного покрытия', 'Маскировка зон, не подлежащих окраске', 'Контроль качества подготовки', 'Навеска изделий на конвейер', 'Соблюдение технологии подготовки'], requirements: ['Среднее образование', 'Опыт работы на участке подготовки от 6 мес', 'Аккуратность', 'Знание химии подготовки поверхности'] },
  
  { id: '27', title: 'Оператор покрасочной камеры', dept: 'Покрасочный участок', reports: 'Мастер участка', subordinates: '—', duties: ['Нанесение порошковой краски', 'Настройка покрасочного пистолета', 'Контроль толщины покрытия', 'Подбор режимов нанесения', 'Контроль качества покрытия', 'Уход за оборудованием камеры', 'Работа с рекуператором'], requirements: ['Среднее образование', 'Опыт порошковой покраски от 1 года', 'Знание технологии порошкового окрашивания', 'Аккуратность'] },
  
  { id: '28', title: 'Оператор печи полимеризации', dept: 'Покрасочный участок', reports: 'Мастер участка', subordinates: '—', duties: ['Управление печью полимеризации', 'Контроль температурного режима', 'Загрузка/выгрузка изделий', 'Контроль времени полимеризации', 'Визуальный контроль покрытия', 'Ведение журнала печи', 'Техобслуживание печи'], requirements: ['Среднее образование', 'Опыт работы с термооборудованием от 6 мес', 'Внимательность', 'Знание режимов полимеризации'] },

  // Упаковка
  { id: '29', title: 'Упаковщик', dept: 'Участок упаковки', reports: 'Мастер участка', subordinates: '—', duties: ['Упаковка готовой продукции', 'Укладка изделий в тару', 'Защита изделий от повреждений', 'Маркировка упаковки', 'Формирование грузовых мест', 'Работа с упаковочными материалами', 'Ведение учёта упакованной продукции'], requirements: ['Среднее образование', 'Опыт работы упаковщиком от 3 мес', 'Аккуратность', 'Физическая выносливость'] },
  
  { id: '30', title: 'Комплектовщик', dept: 'Участок упаковки', reports: 'Мастер участка', subordinates: '—', duties: ['Комплектация заказов по спецификациям', 'Подбор изделий со склада ГП', 'Проверка комплектности отгрузки', 'Маркировка изделий', 'Подготовка сопроводительных документов', 'Передача комплектов на упаковку', 'Работа с накладными'], requirements: ['Среднее образование', 'Внимательность', 'Знание номенклатуры изделий', 'Опыт работы комплектовщиком от 3 мес'] },

  // Блок ПДО
  { id: '31', title: 'Начальник ПДО', dept: 'Планово-диспетчерский отдел', reports: 'Руководитель ПДО', subordinates: 'Плановики, Диспетчеры', duties: ['Планирование производства', 'Формирование производственной программы', 'Контроль выполнения плана', 'Координация работы участков', 'Управление незавершённым производством', 'Анализ загрузки мощностей', 'Отчётность по производству'], requirements: ['Высшее образование', 'Опыт планирования производства от 3 лет', 'Знание 1С, Excel', 'Аналитические способности'] },
  
  { id: '32', title: 'Плановик-нормировщик', dept: 'Планово-диспетчерский отдел', reports: 'Начальник ПДО', subordinates: '—', duties: ['Расчёт плановой трудоёмкости', 'Нормирование операций', 'Формирование сменных заданий', 'Учёт выработки рабочих', 'Анализ выполнения норм', 'Калькуляция себестоимости', 'Ведение нормативной базы'], requirements: ['Высшее или среднее специальное образование', 'Опыт нормирования от 1 года', 'Знание технологий производства', 'Владение Excel, 1С'] },
  
  { id: '33', title: 'Диспетчер производства', dept: 'Планово-диспетчерский отдел', reports: 'Начальник ПДО', subordinates: '—', duties: ['Оперативное отслеживание заказов', 'Контроль прохождения деталей по участкам', 'Выявление и устранение задержек', 'Ведение диспетчерского журнала', 'Информирование о статусе заказов', 'Координация межучастковых перемещений', 'Сбор данных о выработке'], requirements: ['Среднее специальное образование', 'Опыт диспетчерской работы от 1 года', 'Коммуникабельность', 'Стрессоустойчивость'] },

  // Снабжение
  { id: '34', title: 'Начальник отдела снабжения', dept: 'Отдел снабжения', reports: 'Руководитель ПДО', subordinates: 'Менеджеры по закупкам', duties: ['Организация закупок материалов', 'Работа с поставщиками (КУМЗ, Cladding Solutions)', 'Контроль остатков и потребностей', 'Согласование цен и условий поставки', 'Контроль качества поставок', 'Оптимизация закупочных цен', 'Развитие базы поставщиков'], requirements: ['Высшее образование', 'Опыт в закупках от 3 лет', 'Навыки ведения переговоров', 'Знание рынка металлопроката'] },
  
  { id: '35', title: 'Менеджер по закупкам', dept: 'Отдел снабжения', reports: 'Начальник отдела снабжения', subordinates: '—', duties: ['Оформление заявок на закупку', 'Поиск и оценка поставщиков', 'Контроль сроков поставки', 'Ведение договорной работы', 'Решение вопросов по рекламациям', 'Мониторинг цен на материалы', 'Ведение базы поставщиков'], requirements: ['Высшее или среднее специальное образование', 'Опыт работы в закупках от 1 года', 'Знание 1С', 'Коммуникабельность'] },

  // Логистика
  { id: '36', title: 'Логист', dept: 'Отдел логистики', reports: 'Руководитель ПДО', subordinates: 'Водители-экспедиторы', duties: ['Организация доставки сырья и отгрузки ГП', 'Подбор транспортных компаний', 'Оптимизация маршрутов', 'Контроль транспортных расходов', 'Оформление транспортных документов', 'Отслеживание грузов в пути', 'Решение проблем с доставкой'], requirements: ['Высшее или среднее специальное образование', 'Опыт в логистике от 2 лет', 'Знание транспортного рынка', 'Владение Excel, 1С'] },
  
  { id: '37', title: 'Водитель-экспедитор', dept: 'Отдел логистики', reports: 'Логист', subordinates: '—', duties: ['Доставка грузов по маршруту', 'Приёмка и сдача грузов по документам', 'Контроль сохранности груза', 'Оформление товарно-транспортных накладных', 'Своевременная доставка', 'Уход за автомобилем', 'Соблюдение ПДД'], requirements: ['Водительское удостоверение кат. B, C', 'Опыт работы водителем от 2 лет', 'Знание Москвы и области', 'Ответственность'] },

  // Склад
  { id: '38', title: 'Заведующий складом', dept: 'Склад', reports: 'Руководитель ПДО', subordinates: 'Кладовщики, Грузчики', duties: ['Организация работы склада', 'Обеспечение сохранности ТМЦ', 'Контроль приёмки и отпуска материалов', 'Проведение инвентаризаций', 'Оптимизация складских площадей', 'Ведение складского учёта', 'Контроль условий хранения'], requirements: ['Среднее специальное или высшее образование', 'Опыт работы на складе от 3 лет', 'Знание 1С Склад', 'Организаторские способности'] },
  
  { id: '39', title: 'Кладовщик', dept: 'Склад', reports: 'Заведующий складом', subordinates: '—', duties: ['Приёмка материалов на склад', 'Размещение ТМЦ на хранение', 'Отпуск материалов в производство', 'Ведение карточек складского учёта', 'Комплектация материалов по заявкам', 'Участие в инвентаризации', 'Поддержание порядка на складе'], requirements: ['Среднее образование', 'Опыт работы кладовщиком от 6 мес', 'Знание 1С', 'Внимательность'] },
  
  { id: '40', title: 'Грузчик', dept: 'Склад', reports: 'Заведующий складом', subordinates: '—', duties: ['Погрузка и разгрузка материалов', 'Перемещение грузов по складу', 'Укладка материалов на стеллажи', 'Комплектация грузов для отправки', 'Поддержание чистоты на складе', 'Работа с погрузочной техникой', 'Соблюдение техники безопасности'], requirements: ['Среднее образование', 'Физическая выносливость', 'Желательно удостоверение водителя погрузчика', 'Ответственность'] },
];

function generateHtml(pos) {
  const date = new Date().toLocaleDateString('ru-RU');
  return `<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<style>
  @page { size: A4; margin: 20mm 15mm; }
  body { font-family: 'Times New Roman', serif; font-size: 12pt; line-height: 1.5; color: #000; }
  .header { text-align: center; margin-bottom: 20px; }
  .header .company { font-size: 14pt; font-weight: bold; margin-bottom: 5px; }
  .header .doc-type { font-size: 11pt; color: #555; }
  h1 { text-align: center; font-size: 16pt; margin: 30px 0 20px; text-transform: uppercase; }
  h2 { font-size: 13pt; margin: 20px 0 10px; border-bottom: 1px solid #000; padding-bottom: 3px; }
  .info-table { width: 100%; border-collapse: collapse; margin: 15px 0; }
  .info-table td { padding: 5px 10px; border: 1px solid #000; }
  .info-table td:first-child { width: 35%; background: #f5f5f5; font-weight: bold; }
  ol, ul { margin: 10px 0 10px 20px; }
  li { margin: 5px 0; }
  .signature-block { margin-top: 40px; display: flex; justify-content: space-between; }
  .signature { width: 45%; }
  .signature .line { border-bottom: 1px solid #000; height: 25px; margin-top: 30px; }
  .signature .label { font-size: 10pt; color: #555; margin-top: 3px; }
  .footer { margin-top: 40px; font-size: 10pt; color: #666; text-align: center; }
</style>
</head>
<body>
  <div class="header">
    <div class="company">ООО «ЭВЕРЕСТ-ТЕХ»</div>
    <div class="doc-type">ДОЛЖНОСТНАЯ ИНСТРУКЦИЯ</div>
  </div>
  
  <h1>${pos.title}</h1>
  
  <table class="info-table">
    <tr><td>Подразделение</td><td>${pos.dept}</td></tr>
    <tr><td>Подчиняется</td><td>${pos.reports}</td></tr>
    <tr><td>Подчинённые</td><td>${pos.subordinates}</td></tr>
  </table>
  
  <h2>1. Общие положения</h2>
  <ol>
    <li>Настоящая должностная инструкция определяет функциональные обязанности, права и ответственность ${pos.title.toLowerCase()}а ООО «Эверест-Тех».</li>
    <li>${pos.title} относится к категории ${pos.id <= 4 ? 'руководителей' : pos.id <= 15 ? 'специалистов' : 'рабочих'}.</li>
    <li>${pos.title} назначается на должность и освобождается от должности приказом генерального директора.</li>
    <li>${pos.title} подчиняется непосредственно ${pos.reports === '—' ? 'генеральному директору' : pos.reports.toLowerCase() + 'у'}.</li>
  </ol>
  
  <h2>2. Должностные обязанности</h2>
  <p>${pos.title} обязан:</p>
  <ol>
    ${pos.duties.map(d => `<li>${d}.</li>`).join('\n    ')}
  </ol>
  
  <h2>3. Права</h2>
  <p>${pos.title} имеет право:</p>
  <ol>
    <li>Получать информацию, необходимую для выполнения должностных обязанностей.</li>
    <li>Вносить предложения по улучшению работы подразделения.</li>
    <li>Требовать от руководства создания условий для выполнения обязанностей.</li>
    <li>Повышать свою квалификацию.</li>
    ${pos.subordinates !== '—' ? '<li>Давать указания подчинённым работникам и контролировать их выполнение.</li>' : ''}
  </ol>
  
  <h2>4. Ответственность</h2>
  <p>${pos.title} несёт ответственность за:</p>
  <ol>
    <li>Ненадлежащее исполнение должностных обязанностей — в соответствии с трудовым законодательством.</li>
    <li>Причинение материального ущерба — в соответствии с гражданским и трудовым законодательством.</li>
    <li>Нарушение правил охраны труда и пожарной безопасности.</li>
    <li>Разглашение конфиденциальной информации предприятия.</li>
  </ol>
  
  <h2>5. Квалификационные требования</h2>
  <ul>
    ${pos.requirements.map(r => `<li>${r}.</li>`).join('\n    ')}
  </ul>
  
  <div class="signature-block">
    <div class="signature">
      <div>Утверждаю:</div>
      <div class="line"></div>
      <div class="label">Генеральный директор / Рыбаков А.В.</div>
    </div>
    <div class="signature">
      <div>Ознакомлен(а):</div>
      <div class="line"></div>
      <div class="label">ФИО / подпись / дата</div>
    </div>
  </div>
  
  <div class="footer">
    Дата утверждения: ${date} | ООО «Эверест-Тех»
  </div>
</body>
</html>`;
}

async function main() {
  const browser = await puppeteer.launch({ headless: 'new' });
  const page = await browser.newPage();
  
  const outputDir = __dirname;
  
  console.log(`Генерация ${positions.length} должностных инструкций...\\n`);
  
  for (const pos of positions) {
    const html = generateHtml(pos);
    const htmlPath = path.join(outputDir, `temp_${pos.id}.html`);
    fs.writeFileSync(htmlPath, html);
    
    await page.goto(`file://${htmlPath}`, { waitUntil: 'networkidle0' });
    
    const pdfName = `ДИ_${pos.id}_${pos.title.replace(/[\s\/]/g, '_')}.pdf`;
    const pdfPath = path.join(outputDir, pdfName);
    
    await page.pdf({
      path: pdfPath,
      format: 'A4',
      printBackground: true,
      margin: { top: '15mm', bottom: '15mm', left: '15mm', right: '15mm' }
    });
    
    fs.unlinkSync(htmlPath);
    console.log(`✓ ${pdfName}`);
  }
  
  await browser.close();
  console.log(`\\n✅ Готово! ${positions.length} файлов в папке job-descriptions/`);
}

main().catch(console.error);
